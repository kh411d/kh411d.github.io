<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    
    <meta name="twitter:title" content="Build a Medium-Like Clap Button using Svelte Custom Element API"/>
    <meta name="twitter:description" content="Short stories, In August 2017, Medium replaced their Recommend button with a &ldquo;clap&rdquo; button, which readers can click as many times as they want to show how much they enjoyed the article."/>
    <meta name="twitter:site" content="@khalidity"/>
    
    
    
      
      <meta name="twitter:card" content="summary_large_image"/>
      <meta name="twitter:image" content="https://khal.web.id/images/sveltecover.jpg"/>
    

  	<meta property="og:title" content="Build a Medium-Like Clap Button using Svelte Custom Element API &middot; Khalid&#39;s Blog" />
  	<meta property="og:site_name" content="Khalid&#39;s Blog" />
  	<meta property="og:url" content="https://khal.web.id/2020/09/23/build-a-medium-like-clap-button-using-svelte-custom-element-api/" />

    
       <meta property="og:image" content="/images/sveltecover.jpg"/>
    

    
    <meta property="og:description" content="Short stories, In August 2017, Medium replaced their Recommend button with a &ldquo;clap&rdquo; button, which readers can click as many times as they want to show how much they enjoyed the article." />
  	<meta property="og:type" content="article" />
    <meta property="article:published_time" content="2020-09-23T07:48:16&#43;07:00" />

    
    <meta property="article:tag" content="svelte" />
    
    <meta property="article:tag" content="SPA" />
    
    <meta property="article:tag" content="html5" />
    
    <meta property="article:tag" content="tutorial" />
    
    

    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    
    <title>Build a Medium-Like Clap Button using Svelte Custom Element API - Khalid&#39;s Blog</title>
    
    <meta name="description" content="Short stories, In August 2017, Medium replaced their Recommend button with a &ldquo;clap&rdquo; button, which readers can click as many times as they want to show how much they enjoyed the article.">
    <meta name="author" content="">
    
    <link href="https://fonts.googleapis.com/css2?family=Merriweather&family=Open+Sans&display=swap" rel="stylesheet">
    <link href="https://khal.web.id/an-old-hope.min.css" rel="stylesheet">
    <link href="https://khal.web.id/style.css" rel="stylesheet">
    <link href="https://khal.web.id/custom.css" rel="stylesheet">
    <link href="https://khal.web.id/syntax.css" rel="stylesheet">
    
    <link rel="apple-touch-icon" sizes="57x57" href="/images/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/images/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/images/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/images/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/images/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/images/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/images/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/images/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-icon-180x180.png">
    <link rel="icon" type="image/png" sizes="192x192"  href="/images/android-icon-192x192.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="96x96" href="/images/favicon-96x96.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png">
    <link rel='icon' type='image/png' href='/images/favicon.png'>
    <link rel="manifest" href="/images/manifest.json">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/images/ms-icon-144x144.png">
    <meta name="theme-color" content="#ffffff">

    <meta name="generator" content="Hugo 0.74.3" />
    
    
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-8671044-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>

    
      <script async defer src="https://buttons.github.io/buttons.js"></script>
    
    <script src="https://khal.web.id/bundle.js"></script>
  </head>
  <body class="single">
    <header class="header post-head"style="background-image: url(/images/sveltecover.jpg);">   
      <nav class="nav">
        <a class="logo" href="https://khal.web.id/"><img src="/images/logo.jpeg" alt="Home" /></a></p>
        <ul class="menu">
          
          <li>
              <a class="logo" href="mailto:contact@khal.web.id" target="_blank">
                  <span class="icon-mail" style="color:var(--primary);font-size:2em;text-shadow: 0 0 5px white;"></span>
              </a>
          </li>
          
          <li>
            <a class="logo" href="https://www.linkedin.com/in/khalidadisendjaja" target="_blank">
              <span class="icon-linkedin" style="color:var(--primary);font-size:2em;text-shadow: 0 0 5px white;"></span>
          </a>
          </li>

          
          <li>
              <a class="logo" href="https://github.com/kh411d" target="_blank">
              <span class="icon-github" style="color:var(--primary);font-size:2em;text-shadow: 0 0 5px white;"></span>
              </a>
            </li>
          

          
          <li>
            <a class="logo" href="https://twitter.com/khalidity" target="_blank">
                  <span class="icon-twitter" style="color:var(--primary);font-size:2em;text-shadow: 0 0 5px white;"></span>
              </a>
            </li>
          

          

          
          <li>
            <a class="logo" href="https://instagram.com/khalidity" target="_blank">
                  <span class="icon-instagram" style="color:var(--primary);font-size:2em;text-shadow: 0 0 5px white;"></span>
              </a>
          </li>
          
          <li>
            <a class="logo" href="/index.xml" >
              <span class="icon-subscribe" style="color:var(--primary);font-size:2em;text-shadow: 0 0 5px white;"></span>
            </a>
          </li>
        </ul>
      </nav>
    </header>
    <main class="main">     
<article class="post-single">
  <header class="post-header">
    <h1 class="post-title">Build a Medium-Like Clap Button using Svelte Custom Element API</h1>
    <div class="post-meta">September 23, 2020</div>
  </header><div class="sticky-container">
    <div class="share sticky-top sticky-top-offset">
        <ul>       
            <li class="ml-1 mr-1">
                <clap-it style="width:2.2em;height:2.2em;fill:grey;stroke:grey;color:grey;margin:14px auto;" api="https://clapi.vercel.app/api/handler"/>
            </li>
            <li class="ml-1 mr-1">
            <a target="_blank" href="https://twitter.com/intent/tweet?text=Build%20a%20Medium-Like%20Clap%20Button%20using%20Svelte%20Custom%20Element%20API&url=https%3a%2f%2fkhal.web.id%2f2020%2f09%2f23%2fbuild-a-medium-like-clap-button-using-svelte-custom-element-api%2f" onclick="window.open(this.href, 'twitter-share', 'width=550,height=435');return false;">
            <i class="icon-twitter" style="font-size:1.8em"></i>
            </a>
            </li>
            
            <li class="ml-1 mr-1">
            <a target="_blank" href="https://facebook.com/sharer.php?u=https%3a%2f%2fkhal.web.id%2f2020%2f09%2f23%2fbuild-a-medium-like-clap-button-using-svelte-custom-element-api%2f" onclick="window.open(this.href, 'facebook-share', 'width=550,height=435');return false;">
            <i class="icon-facebook" style="font-size:1.8em"></i>
            </a>
            </li>     
        </ul>

        
    </div>
</div><div class="post-content">
    <p>Short stories, In August 2017, Medium replaced their Recommend button with a &ldquo;clap&rdquo; button, which readers can click as many times as they want to show how much they enjoyed the article. Back then, this is how the Medium writers are going to be paid.</p>
<p>Yeah I know, the one that I build is so last years and outdated, but Hey! Why not? It still matters and It doesn’t cost a thing. The clap button still providing good feedback to writers, and it helps them to know which posts do well and which could use some work and hopefully helping people to be better at writing.</p>
<h2 id="hahahugoshortcode-s0-hbhb">




<script
    data-slug-hash="eYZQYWZ"
    data-user="kh411d"
    data-height="328"
    data-default-tab="html,result"
    data-theme-id="dark"
    class='codepen'
    async
    src="//static.codepen.io/assets/embed/ei.js"
></script></h2>
<p>With help from <em><a href="https://svelte.dev/docs#Custom_element_API" target="_blank">Svelte custom element API</a></em>, we can easily create some web components as you see on the codepen editor, <code>&lt;clap-it \&gt;</code> is a custom element that can be very easy to implement in any webpage or working together with another JS Framework/library.</p>
<p><strong>TL; DR;</strong> hopefully you&rsquo;re already familiar with Svelte, I&rsquo;m going to breakdown how I build this component, but first, you need to fork the repository.</p>







    
    
    
    



    






<a 
class="github-button" 
href="https://github.com/kh411d/clap-it/fork"
data-icon="octicon-repo-forked"
aria-label="Fork kh411d/clap-it on GitHub"
 

data-size="large"
>
Fork the repository
</a>
<h2 id="svelte-part">Svelte Part</h2>
<p>Clone the repo and then install all required modules,</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">$ <span class="nb">cd</span> clap-it
$ npm install
</code></pre></td></tr></table>
</div>
</div><p>Open the <code>rollup.config.js</code> file. There are a couple of changes that I&rsquo;ve made to enable custom element and SCSS compiling <em>(svelte-preprocess)</em>,</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-javascript" data-lang="javascript"><span class="c1">// add this import at the top:
</span><span class="c1"></span><span class="kr">import</span> <span class="nx">preprocess</span> <span class="nx">from</span> <span class="s1">&#39;svelte-preprocess&#39;</span><span class="p">;</span>

<span class="cm">/* ... */</span>

<span class="c1">// and add preprocess as a plugin:
</span><span class="c1"></span><span class="kr">export</span> <span class="k">default</span> <span class="p">{</span>
  <span class="cm">/* ... */</span>
  <span class="nx">plugins</span><span class="o">:</span> <span class="p">[</span>
    <span class="nx">svelte</span><span class="p">({</span>
      <span class="cm">/* ... */</span>
      <span class="nx">customElement</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
      <span class="nx">preprocess</span><span class="o">:</span> <span class="nx">preprocess</span><span class="p">()</span>
    <span class="p">})</span>
  <span class="p">}),</span>
  <span class="cm">/* ... */</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>Now, open up <code>clap-it.svelte</code> file in <code>src</code> directory,</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-html" data-lang="html"><span class="p">&lt;</span><span class="nt">svelte:options</span> <span class="na">tag</span><span class="o">=</span><span class="s">&#34;clap-it&#34;</span> <span class="p">/&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p>This tag will compile Svelte component to web component and a tag name should be specified, in this case, the tag name will be <code>clap-it</code>.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-javascript" data-lang="javascript"><span class="kr">import</span> <span class="p">{</span> <span class="nx">onMount</span><span class="p">,</span> <span class="nx">tick</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;svelte&#39;</span><span class="p">;</span>
<span class="kr">export</span> <span class="kd">let</span> <span class="nx">api</span><span class="p">;</span>
<span class="nx">onMount</span><span class="p">(</span><span class="nx">async</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="p">{</span>
  <span class="nx">await</span> <span class="nx">tick</span><span class="p">()</span>
  <span class="kr">const</span> <span class="nx">res</span> <span class="o">=</span> <span class="nx">await</span> <span class="nx">fetch</span><span class="p">(</span> <span class="nx">api</span> <span class="o">+</span>  <span class="sb">`?url=`</span> <span class="o">+</span> <span class="nb">window</span><span class="p">.</span><span class="nx">location</span><span class="p">.</span><span class="nx">href</span> <span class="p">);</span>
  <span class="kd">var</span> <span class="nx">initial</span> <span class="o">=</span> <span class="nx">await</span> <span class="nx">res</span><span class="p">.</span><span class="nx">text</span><span class="p">();</span>
  <span class="nx">counter</span><span class="p">.</span><span class="nx">update</span><span class="p">(</span><span class="nx">n</span> <span class="p">=&gt;</span> <span class="nb">parseInt</span><span class="p">(</span><span class="nx">initial</span><span class="p">,</span><span class="mi">10</span><span class="p">));</span>
<span class="p">});</span>
</code></pre></td></tr></table>
</div>
</div><p>The <code>onMount</code> lifecycle will fetch the initial clap count from the API after the component is first rendered to the DOM. Notice the <code>await tick()</code>, this is a workaround for the <a href="https://github.com/sveltejs/svelte/issues/2227" target="_blank">prop initialization issue in the custom element</a>. If you remove it, you might not be able to access the exported <code>api</code> prop, so the tick is kinda waiting until any pending state changes applied to the DOM.</p>
<p><em>Update</em>, the <code>await tick()</code> workaround currently not working, so this is another workaround,</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-javascript" data-lang="javascript"><span class="nx">onMount</span><span class="p">(()</span> <span class="p">=&gt;</span> <span class="p">{</span>
  <span class="c1">//Waiting for any pending state changes to be applied to the DOM
</span><span class="c1"></span>  <span class="nx">setTimeout</span><span class="p">(</span><span class="nx">async</span> <span class="p">()=&gt;</span> <span class="p">{</span>
    <span class="c1">//GET HTTP API Request based on current url location 
</span><span class="c1"></span>    <span class="kr">const</span> <span class="nx">res</span> <span class="o">=</span> <span class="nx">await</span> <span class="nx">fetch</span><span class="p">(</span> <span class="nx">api</span> <span class="o">+</span>  <span class="sb">`?url=`</span> <span class="o">+</span> <span class="nb">window</span><span class="p">.</span><span class="nx">location</span><span class="p">.</span><span class="nx">href</span> <span class="p">);</span>
    <span class="kd">var</span> <span class="nx">initial</span> <span class="o">=</span> <span class="nx">await</span> <span class="nx">res</span><span class="p">.</span><span class="nx">text</span><span class="p">();</span>
    <span class="c1">//Update store initial value based on API response
</span><span class="c1"></span>    <span class="nx">counter</span><span class="p">.</span><span class="nx">update</span><span class="p">(</span><span class="nx">n</span> <span class="p">=&gt;</span> <span class="nb">parseInt</span><span class="p">(</span><span class="nx">initial</span><span class="p">,</span><span class="mi">10</span><span class="p">));</span>
  <span class="p">},</span> <span class="mi">0</span><span class="p">)</span>
<span class="p">});</span>
</code></pre></td></tr></table>
</div>
</div><p>we need <em><a href="https://svelte.dev/tutorial/writable-stores" target="_blank">svelte/stores</a></em> to be used as a counter, when <code>on:mousedown</code> triggered, the <code>counter</code> will recursively increase the value of both store and the <code>bufferedCount</code> per 200ms, and it stop until <code>on:mouseup</code> triggered.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-javascript" data-lang="javascript"><span class="kr">import</span> <span class="p">{</span> <span class="nx">writable</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;svelte/store&#39;</span><span class="p">;</span>

<span class="kd">let</span> <span class="nx">bufferedCount</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="kr">const</span> <span class="nx">counter</span> <span class="o">=</span> <span class="nx">writable</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<span class="kd">function</span> <span class="nx">increment</span><span class="p">()</span> <span class="p">{</span>
  <span class="nx">addClass</span><span class="p">(</span><span class="s2">&#34;clapped clap&#34;</span><span class="p">,</span> <span class="mi">250</span><span class="p">)</span>
    <span class="nx">count</span><span class="p">.</span><span class="nx">update</span><span class="p">(</span><span class="nx">n</span> <span class="p">=&gt;</span> <span class="p">{</span>
      <span class="nx">bufferedCount</span><span class="o">++</span>
      <span class="k">return</span> <span class="nx">n</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="p">});</span>
    <span class="nx">incTimeout</span> <span class="o">=</span> <span class="nx">setTimeout</span><span class="p">(</span><span class="nx">increment</span><span class="p">,</span> <span class="mi">200</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>The counter will notify the <code>countValue</code> whenever the counter value changes. If there is no changes/update on the counter within 1.5sec, then the <code>bufferedCount</code> will be sent to the API. You might be wondering what is the use of <code>bufferedCount</code> and all the <em>timeout</em>, this is actually a trick, because it would not be efficient to make an API call in every click, so we need to buffer the count for a certain time, in this case within 1.5sec.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-javascript" data-lang="javascript"><span class="kr">const</span> <span class="nx">unsubscribe</span> <span class="o">=</span> <span class="nx">counter</span><span class="p">.</span><span class="nx">subscribe</span><span class="p">(</span><span class="nx">value</span> <span class="p">=&gt;</span> <span class="p">{</span>
  <span class="nx">countValue</span> <span class="o">=</span> <span class="nx">value</span><span class="p">;</span>	
	<span class="k">if</span> <span class="p">(</span><span class="nx">bufferedCount</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
		<span class="nx">clearTimeout</span><span class="p">(</span><span class="nx">timeout</span><span class="p">);</span>
    <span class="nx">timeout</span> <span class="o">=</span> <span class="nx">setTimeout</span><span class="p">(()</span> <span class="p">=&gt;</span> <span class="p">{</span>
      <span class="nx">httpPost</span><span class="p">(</span><span class="nx">api</span><span class="p">,</span><span class="nx">bufferedCount</span><span class="p">,</span> <span class="nb">window</span><span class="p">.</span><span class="nx">location</span><span class="p">.</span><span class="nx">href</span><span class="p">)</span>
      <span class="nx">bufferedCount</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
 		<span class="p">},</span> <span class="mi">1500</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">});</span>
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-html" data-lang="html"><span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;count-container&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;count&#34;</span><span class="p">&gt;</span>{countValue}<span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
  <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="css-styles">CSS Styles</h2>
<p>Open the index file <code>public/index.html</code>, because of the behavior of shadow DOM, styles are encapsulated, any global CSS styles will not be applied to the custom element,</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-html" data-lang="html"><span class="p">&lt;</span><span class="nt">clap-it</span> <span class="na">style</span><span class="o">=</span><span class="s">&#34;width:60px;height:60px;fill:red;stroke:red;color:red;&#34;</span> <span class="na">api</span><span class="o">=</span><span class="s">&#34;&#34;</span><span class="p">/&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p>So, to make a workaround, the styles need to be inlined, we&rsquo;re going to bind the inline style to the clap container by exporting the <code>style</code> prop, whatever style applied to <code>clap-it</code> component will be applied to the container inside the shadow DOM,</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-html" data-lang="html"><span class="p">&lt;</span><span class="nt">script</span><span class="p">&gt;</span>
<span class="p">...</span>
<span class="kr">export</span> <span class="kd">let</span> <span class="nx">style</span><span class="p">;</span>
<span class="p">...</span>
<span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">&#34;clap-container&#34;</span> <span class="na">style</span><span class="o">=</span><span class="s">&#34;{style}&#34;</span><span class="p">&gt;</span>
...
<span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="animation">Animation</h2>
<p>The animation itself is pretty much simple, the button will be animated when increment happened, which is when you clicked the clap button,</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-javascript" data-lang="javascript"><span class="kd">function</span> <span class="nx">increment</span><span class="p">()</span> <span class="p">{</span>
    <span class="p">...</span>
  <span class="nx">addClass</span><span class="p">(</span><span class="s2">&#34;clapped clap&#34;</span><span class="p">,</span> <span class="mi">250</span><span class="p">)</span>
    <span class="p">...</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>The clapped and clap class is going to switch on and off, and creating a small animation on SVG object, the animation is done by using some <code>@keyframes</code> rule. It will gradually change from the current style to the new style at certain times, you need to bind the animation to an element to get an animation to work.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-html" data-lang="html"><span class="p">&lt;</span><span class="nt">svg</span> <span class="na">on:mousedown</span> <span class="na">on:mouseup</span><span class="p">&gt;</span>
    <span class="c">&lt;!-- The Clap icon outline --&gt;</span>
    <span class="p">&lt;</span><span class="nt">g</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;outline&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">g</span><span class="p">&gt;</span> 
    <span class="c">&lt;!-- The Clap icon line sparkle --&gt;</span>
    <span class="p">&lt;</span><span class="nt">g</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;sparkle&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">g</span><span class="p">&gt;</span>
    <span class="c">&lt;!-- The full colored icon clap hand --&gt;</span>
    <span class="p">&lt;</span><span class="nt">g</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;flat&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">g</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">svg</span><span class="p">&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p>For example, open the <code>src/clap-it.scss</code> file, <code>@keyframes blinkin</code> animation is bind to <code>.count</code> class, so then it will create a blinking effect when the <code>.clap</code> class activated.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-scss" data-lang="scss">    <span class="k">&amp;</span><span class="nc">.clap</span> <span class="p">{</span>
    <span class="nc">.sparkle</span> <span class="nt">path</span> <span class="p">{</span>
        <span class="k">@include</span><span class="nd"> animate-once</span><span class="p">(</span><span class="n">spark</span><span class="p">);</span>
      <span class="p">}</span>
      <span class="k">@include</span><span class="nd"> animate-once</span><span class="p">(</span><span class="n">pulse</span><span class="p">);</span>
      <span class="nc">.count</span> <span class="p">{</span>
        <span class="k">@include</span><span class="nd"> animate-once</span><span class="p">(</span><span class="n">blinkin</span><span class="p">);</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="k">@keyframes</span> <span class="nt">blinkin</span> <span class="p">{</span>
    <span class="nt">0</span><span class="err">%</span><span class="o">,</span>
    <span class="nt">50</span><span class="err">%</span><span class="o">,</span>
    <span class="nt">100</span><span class="err">%</span> <span class="p">{</span>
      <span class="nt">opacity</span><span class="nd">:</span> <span class="nt">1</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="nt">25</span><span class="err">%</span><span class="o">,</span>
    <span class="nt">75</span><span class="err">%</span> <span class="p">{</span>
      <span class="nt">opacity</span><span class="nd">:</span> <span class="nt">0</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="usage">Usage</h2>
<p>After npm build, <code>bundle.js</code> will be created in <code>public/build</code> directory,</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">$ <span class="nb">cd</span> clap-it
$ npm run build <span class="o">&amp;&amp;</span> npm run start
</code></pre></td></tr></table>
</div>
</div><p>Last time I checked, the size of <code>bundle.js</code> is approx 16kb, and it&rsquo;s only 6kb gzipped, pretty small isn&rsquo;t it. This bundle already includes all the JS code, CSS code, and also the SVG. to make it work, all you need to do is to apply the <code>bundle.js</code> and the <code>&lt;clap-it /&gt;</code> custom tag on any webpage you want.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-html" data-lang="html"><span class="p">&lt;</span><span class="nt">html</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">script</span> <span class="na">src</span><span class="o">=</span><span class="s">&#39;http:// your-website .com/js/bundle.js&#39;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
    <span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">clap-it</span> <span class="na">style</span><span class="o">=</span><span class="s">&#34;width:60px;height:60px;fill:red;stroke:red;color:red;&#34;</span> <span class="na">api</span><span class="o">=</span><span class="s">&#34;&#34;</span><span class="p">/&gt;</span>
    <span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p>I know it&rsquo;s not perfect, feel free to make your own modification, my goal is only to make it works. Please let me know if you made some changes or found some bugs.</p>
<p>Soon, I&rsquo;m going to publish a working API to be paired with this component, stay tune.</p>
<p><em>Update</em>, Check it out! <a href="https://khal.web.id/2020/09/26/practical-rest-api-in-go-on-cheap-serverless/" target="_blank">Practical REST API in Go on Cheap Serverless</a></p>
<blockquote>
<p>Well, I suppose, these days onward you can clap only with one hand.</p>
</blockquote>

  </div>
<section class="share-footer">
  <h6 style="color:var(--secondary);">Share this post</h6>
  <ul>
    <li>
      <clap-it style="width:45px;height:45px;fill:grey;stroke:grey;color:grey;margin:2px 0px;" api="https://clapi.vercel.app/api/handler"/>
    </li>
      <li>
        <a  style="font-size: 2.5em" href="https://twitter.com/share?text=Build%20a%20Medium-Like%20Clap%20Button%20using%20Svelte%20Custom%20Element%20API&nbsp;-&nbsp;Khalid%27s%20Blog&amp;url=https%3a%2f%2fkhal.web.id%2f2020%2f09%2f23%2fbuild-a-medium-like-clap-button-using-svelte-custom-element-api%2f"
        onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
            <span class="icon-twitter" style="color:var(--secondary);"></span>
        </a>
      </li>
      <li>
        <a  style="font-size: 2.5em" href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fkhal.web.id%2f2020%2f09%2f23%2fbuild-a-medium-like-clap-button-using-svelte-custom-element-api%2f"
        onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;">
            <span class="icon-facebook" style="color:var(--secondary);"></span>
        </a>
      </li>
  </ul>
</section>


  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://khal.web.id/tags/svelte">svelte</a></li>
      <li><a href="https://khal.web.id/tags/SPA">SPA</a></li>
      <li><a href="https://khal.web.id/tags/html5">html5</a></li>
      <li><a href="https://khal.web.id/tags/tutorial">tutorial</a></li>
    </ul>
  </footer>
  
</article></main>
<footer class="footer">
  <span>&copy; 2020 <a href="https://khal.web.id/">Khalid&#39;s Blog</a></span>
  <span>&middot;</span>
  <span>Powered by <a href="https://gohugo.io/" rel="noopener" target="_blank">Hugo️️</a>️</span>
  <span>&middot;</span>
  <span>Theme️ <a href="https://github.com/nanxiaobei/hugo-paper" rel="noopener" target="_blank">Paper</a></span>
</footer>
</body>
</html>

